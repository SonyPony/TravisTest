os:
  - linux

language:
  - cpp


install:
    #- sudo apt-get install rubygems lcov
    #- gem install coveralls-lcov

    - sudo pip install cpp-coveralls

    - sudo apt-add-repository -y ppa:ubuntu-toolchain-r/test
    - sudo add-apt-repository --yes ppa:beineri/opt-qt55
    - sudo apt-get update -qq
    - sudo apt-get install -qq g++-4.8 libc6-i386
    - sudo apt-get install -qq qt-latest
    - export CXX="g++-4.8"
    - export CC="gcc-4.8"

script:
    - QTDIR="/opt/qt55"
    - PATH="$QTDIR/bin:$PATH"
    - qt55-env.sh 

    #- ./configure --enable-gcov
    - qmake -v
    - qmake TravisTest.pro CONFIG+=debug "QT += testlib"
    #- qmake

    #- make coverage
    #- cat coverage/Irc*.cov > Communi.cov
    #- coveralls-lcov Communi.cov
    - make
    #- make check

    - export DISPLAY=:99.0
    - sh -e /etc/init.d/xvfb start
    - sleep 3

    - ./TravisTest --test
    - ls

after_success:
    - echo `pwd`
    - coveralls -b $PWD
    #- coveralls --exclude lib --exclude tests --gcov-options '\-lp'
    #- coveralls --build-root "build"
